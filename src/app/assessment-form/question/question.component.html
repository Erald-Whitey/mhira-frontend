<nz-card
  [nzTitle]="question.label"
  [nzExtra]="hint"
  class="multiline-header"
  *ngIf="question.type !== QuestionType.NOTE; else note"
>
  <ng-container [ngSwitch]="question.type" *ngIf="question && answer?.question">
    <ng-container *ngSwitchCase="QuestionType.TEXT">
      <input
        #textInput
        nz-input
        [value]="answer.textValue"
        (change)="answer.textValue = textInput.value; sendAnswer(answer)"
      />
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.DECIMAL">
      <nz-input-number
        [nzStep]="0.1"
        [(ngModel)]="answer.numberValue"
        (ngModelChange)="sendAnswer(answer)"
      ></nz-input-number>
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.INTEGER">
      <nz-input-number
        [nzStep]="1"
        [(ngModel)]="answer.numberValue"
        (ngModelChange)="sendAnswer(answer)"
      ></nz-input-number>
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.CHECKBOX">
      <label nz-checkbox [(ngModel)]="answer.booleanValue" (ngModelChange)="sendAnswer(answer)"></label>
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.DATE">
      <nz-date-picker
        [nzFormat]="this.dateFormat"
        [(ngModel)]="answer.dateValue"
        (ngModelChange)="sendAnswer(answer)"
      ></nz-date-picker>
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.TIME">
      <input
        #timeInput
        type="time"
        nz-input
        [value]="answer.textValue"
        (change)="answer.textValue = timeInput.value; sendAnswer(answer)"
      />
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.DATETIME">
      <div class="row">
        <nz-date-picker
          [nzFormat]="this.dateFormat"
          [(ngModel)]="answer.dateValue"
          (ngModelChange)="sendAnswer(answer)"
        ></nz-date-picker>
        <input
          #timeInput
          type="time"
          nz-input
          [value]="answer.textValue"
          (change)="answer.textValue = timeInput.value; sendAnswer(answer)"
        />
      </div>
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.SELECT_ONE">
      <app-select-question
        [question]="question"
        [answer]="answer"
        (answerChange)="sendAnswer($event)"
      ></app-select-question>
    </ng-container>
    <ng-container *ngSwitchCase="QuestionType.SELECT_MULTIPLE">
      <app-multiselect-question
        [question]="question"
        [answer]="answer"
        (answerChange)="sendAnswer($event)"
      ></app-multiselect-question>
    </ng-container>
    <ng-container *ngSwitchDefault>
      <nz-tag nzColor="warning">
        <i nz-icon nzType="exclamation-circle"></i>
        <span>unsupported question-type "{{ question.type }}"</span>
      </nz-tag>
    </ng-container>
  </ng-container>
</nz-card>

<ng-template #hint>
  <button
    *ngIf="question.hint"
    nz-button
    nzShape="circle"
    nzSize="small"
    nz-tooltip
    [nzTooltipTitle]="question.hint"
    class="hint"
  >
    <i nz-icon nzType="question"></i>
  </button>
</ng-template>

<ng-template #note>
  <nz-card>
    <div class="note">
      <i nz-icon nzType="exclamation-circle" nzSize="big"></i>
      <p>{{ question.label }}</p>
    </div>
  </nz-card>
</ng-template>
